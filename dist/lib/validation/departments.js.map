{"version":3,"sources":["../../../lib/validation/departments.js"],"names":["validateDepartment","data","supplierData","JSON","parse","result","finalObject","request","map","row","Promise","resolve","reject","department_id","errorID","errorField","errorReason","name","floor_area","isNaN","source_system","supplier_id","push","all","module","exports"],"mappings":"AAAA;AACA;;AAEA;;;;;;;;AAKA,IAAMA;AAAA,qEAAqB,iBAAMC,IAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAEnBC,wBAFmB,GAEJC,KAAKC,KAAL,CAAWH,IAAX,CAFI;AAGrBI,kBAHqB,GAGZ,EAHY;AAIrBC,uBAJqB,GAIP,EAJO;AAMrBC,mBANqB,GAMXL,aAAaM,GAAb,CAAiB,UAACC,GAAD,EAAS;AACtC,qBAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;;AAEtC;;;;;;;;AAQA,oBAAI,CAACH,IAAII,aAAT,EAAwB;AACtBR,yBAAOS,OAAP,GAAiB,EAAjB;AACAT,yBAAOU,UAAP,GAAoB,eAApB;AACAV,yBAAOW,WAAP,GAAqB,2BAArB;AACAJ,yBAAOP,MAAP;AACD,iBALD,MAKO;;AAEL,sBAAI,OAAOI,IAAII,aAAX,KAA6B,QAAjC,EAA2C;AACzCR,2BAAOS,OAAP,GAAiB,EAAjB;AACAT,2BAAOU,UAAP,GAAoB,eAApB;AACAV,2BAAOW,WAAP,GAAqB,cAArB;AACAJ,2BAAOP,MAAP;AACD;AACF;;AAGD,oBAAI,CAACI,IAAIQ,IAAT,EAAe;AACbZ,yBAAOS,OAAP,GAAiBL,IAAII,aAArB;AACAR,yBAAOU,UAAP,GAAoB,MAApB;AACAV,yBAAOW,WAAP,GAAqB,2BAArB;AACAJ,yBAAOP,MAAP;AACD,iBALD,MAKO;;AAEL,sBAAI,OAAOI,IAAIQ,IAAX,KAAoB,QAAxB,EAAkC;AAChCZ,2BAAOS,OAAP,GAAiBL,IAAII,aAArB;AACAR,2BAAOU,UAAP,GAAoB,MAApB;AACAV,2BAAOW,WAAP,GAAqB,cAArB;AACAJ,2BAAOP,MAAP;AACD;AACF;;AAED,oBAAII,IAAIS,UAAR,EAAoB;AAClB,sBAAIC,MAAMV,IAAIS,UAAV,CAAJ,EAA2B;AACzBb,2BAAOS,OAAP,GAAiBL,IAAII,aAArB;AACAR,2BAAOU,UAAP,GAAoB,YAApB;AACAV,2BAAOW,WAAP,GAAqB,eAArB;AACAJ,2BAAOP,MAAP;AACD;AACF,iBAPD,MAOO;AACLI,sBAAIS,UAAJ,GAAiB,CAAjB;AACD;;AAGD,oBAAIT,IAAIW,aAAR,EAAuB;AACrB,sBAAI,OAAOX,IAAIW,aAAX,KAA6B,QAAjC,EAA2C;AACzCf,2BAAOS,OAAP,GAAiBL,IAAIY,WAArB;AACAhB,2BAAOU,UAAP,GAAoB,eAApB;AACAV,2BAAOW,WAAP,GAAqB,cAArB;AACAJ,2BAAOP,MAAP;AACD;AACF,iBAPD,MAOO;AACLI,sBAAIW,aAAJ,GAAoB,EAApB;AACD;;AAGDd,4BAAYgB,IAAZ,CAAiBb,GAAjB;AACAE,wBAAQF,GAAR;AACD,eAnEM,CAAP;AAoED,aArEa,CANW;AAAA;AAAA,mBA6EZC,QAAQa,GAAR,CAAYhB,OAAZ,CA7EY;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAArB;;AAAA;AAAA;AAAA;AAAA,GAAN;;AAiFAiB,OAAOC,OAAP,GAAiB;AACfzB;AADe,CAAjB","file":"departments.js","sourcesContent":["/* eslint-disable valid-jsdoc */\n'use strict';\n\n/**\n * @author Dave Grix\n * @param data string\n * @return array\n */\nconst validateDepartment = async(data) => {\n\n  const supplierData = JSON.parse(data);\n  let result = {};\n  let finalObject = [];\n\n  let request = supplierData.map((row) => {\n    return new Promise((resolve, reject) => {\n\n      /**\n       * @param row object\n       * @param row.department_id string required\n       * @param row.name string required\n       * @param row.floor_area number\n       * @param row.source_system string\n       */\n\n      if (!row.department_id) {\n        result.errorID = '';\n        result.errorField = 'department_id';\n        result.errorReason = 'Missing Required Property';\n        reject(result);\n      } else {\n\n        if (typeof row.department_id !== 'string') {\n          result.errorID = '';\n          result.errorField = 'department_id';\n          result.errorReason = 'Not a String';\n          reject(result);\n        }\n      }\n\n\n      if (!row.name) {\n        result.errorID = row.department_id;\n        result.errorField = 'name';\n        result.errorReason = 'Missing Required Property';\n        reject(result);\n      } else {\n\n        if (typeof row.name !== 'string') {\n          result.errorID = row.department_id;\n          result.errorField = 'name';\n          result.errorReason = 'Not a String';\n          reject(result);\n        }\n      }\n\n      if (row.floor_area) {\n        if (isNaN(row.floor_area)) {\n          result.errorID = row.department_id;\n          result.errorField = 'floor_area';\n          result.errorReason = 'Not a Number!';\n          reject(result);\n        }\n      } else {\n        row.floor_area = 0;\n      }\n\n\n      if (row.source_system) {\n        if (typeof row.source_system !== 'string') {\n          result.errorID = row.supplier_id;\n          result.errorField = 'source_system';\n          result.errorReason = 'Not a String';\n          reject(result);\n        }\n      } else {\n        row.source_system = '';\n      }\n\n\n      finalObject.push(row);\n      resolve(row);\n    });\n  });\n\n  return await Promise.all(request);\n\n};\n\nmodule.exports = {\n  validateDepartment\n};\n\n"]}